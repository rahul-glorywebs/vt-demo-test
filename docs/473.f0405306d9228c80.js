"use strict";(self.webpackChunkvirtual_trust=self.webpackChunkvirtual_trust||[]).push([[473],{7473:(G,w,a)=>{a.r(w),a.d(w,{AuthModule:()=>D});var m=a(6895),i=a(4006),p=a(1572),C=a(8032),u=a(6438),P=a(2721),e=a(4650);let A=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-auth"]],decls:2,vars:0,template:function(o,n){1&o&&(e.ynx(0),e._UZ(1,"router-outlet"),e.BQk())},dependencies:[u.lC]}),s})();var h=a(4968),v=a(4004),Z=a(8372),T=a(1884),g=a(9988);const I=["confirmPasswordInput"],S=["passwordInput"];function b(s,r){1&s&&(e.TgZ(0,"span"),e._uU(1,"Password is required."),e.qZA())}function F(s,r){1&s&&(e.TgZ(0,"span"),e._uU(1,"Password is too short (minimum 8 character required)."),e.qZA())}function y(s,r){1&s&&(e.TgZ(0,"span"),e._uU(1," Password The password must contain letter (uppercase or lowercase, digit special character from the set $, @, $, !, %, *, #, ?, or & and at least 8 characters long) . "),e.qZA())}function q(s,r){if(1&s&&(e.TgZ(0,"div",38),e.YNc(1,b,2,0,"span",39),e.YNc(2,F,2,0,"span",39),e.YNc(3,y,2,0,"span",39),e.qZA()),2&s){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.changePasswordForm.controls.password.hasError("required")),e.xp6(1),e.Q6J("ngIf",o.changePasswordForm.controls.password.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",o.changePasswordForm.controls.password.hasError("pattern"))}}function x(s,r){1&s&&(e.TgZ(0,"span"),e._uU(1," Confirm password Required. "),e.qZA())}function L(s,r){1&s&&(e.TgZ(0,"span"),e._uU(1," Confirm password does not match with entered password. "),e.qZA())}function M(s,r){if(1&s&&(e.TgZ(0,"div",38),e.YNc(1,x,2,0,"span",39),e.YNc(2,L,2,0,"span",39),e.qZA()),2&s){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.changePasswordForm.controls.confirmPassword.hasError("required")),e.xp6(1),e.Q6J("ngIf",!o.changePasswordForm.controls.confirmPassword.hasError("required")&&!o.isPasswordMatch)}}function _(s,r){1&s&&(e.TgZ(0,"button",40),e._uU(1,"Reset Password"),e.qZA())}function R(s,r){1&s&&e._UZ(0,"mat-spinner",41)}let J=(()=>{class s{constructor(o,n,t,l,c){this.formBuilder=o,this.router=n,this.snackbarService=t,this.authService=l,this.location=c,this.isLoading=!1,this.isPasswordMatch=!1,this.state$=this.location.getState(),this.state$?(this.loginResponseData=this.state$.loginResponseData,this.email=this.state$.emailId):this.router.navigate(["/auth"])}ngOnInit(){this.formInit()}ngAfterViewInit(){(0,h.R)(this.passwordInput.nativeElement,"keyup").pipe((0,v.U)(t=>t.target.value),(0,Z.b)(500),(0,T.x)()).subscribe(t=>{this.isPasswordMatch=this.changePasswordForm.controls.confirmPassword.value===t}),(0,h.R)(this.confirmPasswordInput.nativeElement,"keyup").pipe((0,v.U)(t=>t.target.value),(0,Z.b)(500),(0,T.x)()).subscribe(t=>{this.isPasswordMatch=this.changePasswordForm.controls.password.value===t})}formInit(){this.changePasswordForm=this.formBuilder.group({password:["",[i.kI.required,i.kI.pattern(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%#?&\[])[A-Za-z\d$@$!%*#?&\[\]]{8,}$/),i.kI.minLength(8)]],confirmPassword:["",[i.kI.required]]})}updatePassword(){if(this.isLoading=!0,this.changePasswordForm.valid&&this.isPasswordMatch){const o=this.loginResponseData.loginResponse[0],n=this.loginResponseData?.businessKey;let t;t=o?o.emailId:this.email;const l=this.changePasswordForm.controls.password.value;n&&t&&l&&this.authService.changePassword({businessKey:n,email:t,newPassword:l}).subscribe({next:d=>{this.isLoading=!1,d.status&&(this.snackbarService.openSnackBar(d.status,"Close","success-snackbar"),this.router.navigate(["/auth/login"]).then(()=>{localStorage.clear(),sessionStorage.clear()}))},error:d=>{this.isLoading=!1,console.log(d),this.snackbarService.openSnackBar(d.error.errorMessage,"Close","error-snackbar")}})}else this.changePasswordForm.markAllAsTouched(),this.changePasswordForm.markAsDirty(),this.changePasswordForm.updateValueAndValidity()}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(i.qu),e.Y36(u.F0),e.Y36(g.o),e.Y36(g.e8),e.Y36(m.Ye))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-change-password"]],viewQuery:function(o,n){if(1&o&&(e.Gf(I,5,e.SBq),e.Gf(S,5,e.SBq)),2&o){let t;e.iGM(t=e.CRH())&&(n.confirmPasswordInput=t.first),e.iGM(t=e.CRH())&&(n.passwordInput=t.first)}},decls:60,vars:5,consts:[[1,"login-section"],[1,"container-fluid"],[1,"row","main-row","align-items-stretch"],[1,"col-12","col-lg-6","col-xl-4","d-flex","align-items-center"],[1,"login-wrap"],[1,"login-logo-wrp","text-center"],["width","58","height","57","viewBox","0 0 58 57","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M28.5391 0C12.7989 0 0.0390625 12.7599 0.0390625 28.5C15.7792 28.5 28.5391 15.7401 28.5391 0Z","fill","#0066FF"],["d","M28.5391 57C44.2792 57 57.0391 44.2401 57.0391 28.5C41.2989 28.5 28.5391 41.2599 28.5391 57Z","fill","#0066FF"],["d","M28.5391 0C44.2792 0 57.0391 12.7599 57.0391 28.5C41.2989 28.5 28.5391 15.7401 28.5391 0Z","fill","#7FB2FF"],["d","M28.5391 57C12.7989 57 0.0390611 44.2401 0.0390625 28.5C15.7792 28.5 28.5391 41.2599 28.5391 57Z","fill","#7FB2FF"],[1,"login-form-title"],[1,"form-wrp"],[1,"login-form-name-inner","text-center"],[1,"login-form-subname-inner","text-center"],["id","loginform",3,"formGroup","ngSubmit"],[1,"row"],[1,"form-group","col-12"],[1,"field-wrap"],[1,"form-label"],["for","uname"],[1,"form-element"],["type","password","name","password","placeholder","Enter your new password","formControlName","password","required",""],["passwordInput",""],["class","error-message",4,"ngIf"],["type","password","name","confirmPassword","placeholder","Re-enter your password","formControlName","confirmPassword","required",""],["confirmPasswordInput",""],[1,"form-group","button-wrap","col-md-12"],[1,"field-wrap","text-center"],["type","submit","class","btn btn-primary",4,"ngIf"],[1,"spinner-container"],["diameter","30",4,"ngIf"],[1,"col-12","col-lg-6","col-xl-8","p-0"],[1,"login-background"],[1,"login-logo-right","text-center"],[1,"logo-img-wrap"],["src","assets/images/logo.png","alt","logo","width","92","height","91"],[1,"login-form-sub-title"],[1,"error-message"],[4,"ngIf"],["type","submit",1,"btn","btn-primary"],["diameter","30"]],template:function(o,n){1&o&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e.O4$(),e.TgZ(6,"svg",6),e._UZ(7,"path",7)(8,"path",8)(9,"path",9)(10,"path",10),e.qZA(),e.kcU(),e.TgZ(11,"div",11),e._uU(12,"Welcome to VirtualTRUST"),e.TgZ(13,"sup"),e._uU(14,"TM"),e.qZA()()(),e.TgZ(15,"div",12)(16,"div",13),e._uU(17,"Reset Password"),e.qZA(),e.TgZ(18,"div",14),e._uU(19,"Need re-login once you reset password."),e.qZA(),e.TgZ(20,"form",15),e.NdJ("ngSubmit",function(){return n.updatePassword()}),e.TgZ(21,"div",16)(22,"div",17)(23,"div",18)(24,"div",19)(25,"label",20),e._uU(26,"Password*"),e.qZA()(),e.TgZ(27,"div",21),e._UZ(28,"input",22,23),e.qZA(),e.YNc(30,q,4,3,"div",24),e.qZA()()(),e.TgZ(31,"div",16)(32,"div",17)(33,"div",18)(34,"div",19)(35,"label",20),e._uU(36,"Confirm Password*"),e.qZA()(),e.TgZ(37,"div",21),e._UZ(38,"input",25,26),e.qZA(),e.YNc(40,M,3,2,"div",24),e.qZA()()(),e.TgZ(41,"div",16)(42,"div",27)(43,"div",28),e.YNc(44,_,2,0,"button",29),e.TgZ(45,"div",30),e.YNc(46,R,1,0,"mat-spinner",31),e.qZA()()()()()()()(),e.TgZ(47,"div",32)(48,"div",33)(49,"div",34)(50,"div",35),e._UZ(51,"img",36),e.qZA(),e.TgZ(52,"div",11),e._uU(53,"VirtualTRUST"),e.TgZ(54,"sup"),e._uU(55,"TM"),e.qZA()(),e.TgZ(56,"div",37),e._uU(57,"Login to get started with VirtualTRUST"),e.TgZ(58,"sup"),e._uU(59,"TM"),e.qZA()()()()()()()()),2&o&&(e.xp6(20),e.Q6J("formGroup",n.changePasswordForm),e.xp6(10),e.Q6J("ngIf",n.changePasswordForm.controls.password.dirty||n.changePasswordForm.controls.password.touched),e.xp6(10),e.Q6J("ngIf",n.changePasswordForm.controls.confirmPassword.dirty||n.changePasswordForm.controls.confirmPassword.touched),e.xp6(4),e.Q6J("ngIf",!n.isLoading),e.xp6(2),e.Q6J("ngIf",n.isLoading))},dependencies:[m.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,p.Ou]}),s})();var N=a(7579),Y=a(2722),k=a(590),f=a(8e3);function B(s,r){1&s&&(e.TgZ(0,"div",48),e._uU(1," Please enter an username. "),e.qZA())}function V(s,r){1&s&&(e.TgZ(0,"div",48),e._uU(1," Please enter a password. "),e.qZA())}function Q(s,r){1&s&&(e.TgZ(0,"button",49),e._uU(1,"Login"),e.qZA())}function O(s,r){1&s&&e._UZ(0,"mat-spinner",50)}const E=[{path:"",component:A,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:(()=>{class s{constructor(o,n,t,l,c,d){this.formBuilder=o,this.authService=n,this.router=t,this.patientService=l,this.snackbarService=c,this.logoutService=d,this.isLoading=!1,this.unSubscriber=new N.x}ngOnInit(){history.pushState(null,""),this.formInit(),(0,h.R)(window,"popstate").pipe((0,Y.R)(this.unSubscriber)).subscribe(o=>{history.pushState(null,"")})}formInit(){this.loginForm=this.formBuilder.group({username:["",i.kI.required],password:["",i.kI.required]})}logIn(){if(this.loginForm.valid){this.isLoading=!0;const o=this.loginForm.value;let n={};this.authService.login(o).pipe((0,k.P)()).subscribe({next:t=>{if(t.userLoginStatus){if(this.isLoading=!1,"Yes"===t.userMustChangePassword)return localStorage.setItem("vt-demo-isUserLoginFirstTime","1"),void this.router.navigateByUrl("/auth/change-password",{state:{loginResponseData:t,emailId:o.username}}).then(()=>{localStorage.setItem("vt-demo-previousVisitedUrl","/auth/change-password")});this.loginForm.reset(),localStorage.setItem("vt-demo-isUserLogin","1");const l={businessKey:t.businessKey,processDefinitionId:t.processDefinitionId,processId:t.processId,userEmail:o.username};sessionStorage.setItem("businessAndProcessDetails",JSON.stringify(l)),1===t.loginResponse.length?(sessionStorage.setItem("tenantUserLoginInfo",JSON.stringify(t.loginResponse[0])),localStorage.setItem("vt-demo-isMultiTenantUser","0"),this.afterUserLogin(t,t.userLoginStatus)):t.loginResponse.length>1&&(n.status=t.userLoginStatus,n.userLoginResponse=t.userLoginResponse,n.data=t.loginResponse,n.userMustChangePassword=t.userMustChangePassword,sessionStorage.setItem("tenantUserList",JSON.stringify(n)),localStorage.setItem("vt-demo-isMultiTenantUser","1"),this.showTenantPicker()),setInterval(()=>{this.logoutAfterSessionExpire(l)},72e5)}},error:t=>{this.isLoading=!1,localStorage.setItem("vt-demo-isUserLogin",""),console.log(t),this.snackbarService.openSnackBar(t.error.userLoginResponse,"Close","error-snackbar")}})}else this.loginForm.markAllAsTouched(),this.loginForm.updateValueAndValidity()}showTenantPicker(){this.router.navigate(["/tenant-users"]).then(()=>{localStorage.setItem("vt-demo-previousVisitedUrl","/tenant-users"),(0,f.$z)(1)})}afterUserLogin(o,n){if(n)if("Practitioner"===o.loginResponse[0].userType)localStorage.setItem("vt-demo-userType","Practitioner"),sessionStorage.setItem("userAllMenuAccessResponse2",JSON.stringify(o.userAllMenuAccessResponse2)),this.router.navigate(["/patients"]).then(()=>{localStorage.setItem("vt-demo-previousVisitedUrl","/patients"),(0,f.$z)(o.loginResponse[0].themeId)});else{localStorage.removeItem("isMultiTenantUser"),localStorage.setItem("vt-demo-userType","Patient"),sessionStorage.setItem("userAllMenuAccessResponse2",JSON.stringify(o.userAllMenuAccessResponse2));const t={fullUrl:"",resource:JSON.parse(o.loginResponse[0].userJson),search:{mode:""}};sessionStorage.setItem("patient",JSON.stringify(t)),this.router.navigateByUrl("/dashboard",{state:{patient:t}}).then(()=>{localStorage.setItem("vt-demo-previousVisitedUrl","/dashboard"),(0,f.$z)(o.loginResponse[0].themeId)})}}ngOnDestroy(){this.unSubscriber.next(),this.unSubscriber.complete()}logoutAfterSessionExpire(o){const n=o.businessKey;n&&this.logoutService.logoutUser({businessKey:n})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(i.qu),e.Y36(g.e8),e.Y36(u.F0),e.Y36(g.e6),e.Y36(g.o),e.Y36(g.PO))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-login"]],decls:75,vars:5,consts:[[1,"login-section"],[1,"container-fluid"],[1,"row","main-row","align-items-stretch"],[1,"col-12","col-lg-6","col-xl-4","d-flex","align-items-center"],[1,"login-wrap"],[1,"login-logo-wrp","text-center"],["width","58","height","57","viewBox","0 0 58 57","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M28.5391 0C12.7989 0 0.0390625 12.7599 0.0390625 28.5C15.7792 28.5 28.5391 15.7401 28.5391 0Z","fill","#0066FF"],["d","M28.5391 57C44.2792 57 57.0391 44.2401 57.0391 28.5C41.2989 28.5 28.5391 41.2599 28.5391 57Z","fill","#0066FF"],["d","M28.5391 0C44.2792 0 57.0391 12.7599 57.0391 28.5C41.2989 28.5 28.5391 15.7401 28.5391 0Z","fill","#7FB2FF"],["d","M28.5391 57C12.7989 57 0.0390611 44.2401 0.0390625 28.5C15.7792 28.5 28.5391 41.2599 28.5391 57Z","fill","#7FB2FF"],[1,"login-form-title"],[1,"form-wrp"],[1,"login-form-name-inner","text-center"],["width","28","height","28","viewBox","0 0 28 28","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M8.3435 0.5H19.6565C24.5705 0.5 27.5 3.4295 27.5 8.3435V19.6565C27.5 23.45 25.7585 26.0555 22.694 27.041C21.803 27.3515 20.777 27.5 19.6565 27.5H8.3435C7.223 27.5 6.197 27.3515 5.306 27.041C2.2415 26.0555 0.5 23.45 0.5 19.6565V8.3435C0.5 3.4295 3.4295 0.5 8.3435 0.5ZM17.1505 13.2583C16.3149 14.0667 15.1817 14.5208 14 14.5208C12.8183 14.5208 11.6851 14.0667 10.8495 13.2583C10.014 12.45 9.54455 11.3536 9.54455 10.2104C9.54455 9.06723 10.014 7.97085 10.8495 7.16249C11.6851 6.35413 12.8183 5.9 14 5.9C15.1817 5.9 16.3149 6.35413 17.1505 7.16249C17.986 7.97085 18.4554 9.06723 18.4554 10.2104C18.4554 11.3536 17.986 12.45 17.1505 13.2583ZM5.9 23.1417C5.9 19.5727 9.53564 16.6761 14 16.6761C18.4644 16.6761 22.1 19.5727 22.1 23.1417C22.1 23.3831 21.904 23.5727 21.6545 23.5727H6.34554C6.09604 23.5727 5.9 23.3831 5.9 23.1417Z","fill","#0066FF"],[1,"login-form-subname-inner","text-center"],["id","loginform",3,"formGroup","ngSubmit"],[1,"row"],[1,"form-group","col-12"],[1,"field-wrap"],[1,"form-label"],["for","uname"],[1,"form-element"],["type","email","name","uname","placeholder","Enter your email address","formControlName","username","required",""],["class","error-message",4,"ngIf"],["type","password","name","password","placeholder","Enter your password","formControlName","password","required",""],[1,"row","align-items-center"],[1,"form-group","col-6"],[1,"checkbox-wrap"],["for","rememberme",1,"checked-item","mb-0"],["id","rememberme","type","checkbox"],[1,"checkmark"],[1,"form-group","col-6","text-end"],[1,"forgotten-password"],["href","#"],[1,"form-group","button-wrap","col-md-12"],[1,"field-wrap","text-center"],["type","submit","class","btn btn-primary",4,"ngIf"],[1,"spinner-container"],["diameter","30",4,"ngIf"],[1,"create-account","text-center"],[1,"col-12","col-lg-6","col-xl-8","p-0"],[1,"login-background"],[1,"login-logo-right","text-center"],[1,"logo-img-wrap"],["src","assets/images/logo.png","alt","logo","width","92","height","91"],[1,"login-form-sub-title"],[1,"error-message"],["type","submit",1,"btn","btn-primary"],["diameter","30"]],template:function(o,n){1&o&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e.O4$(),e.TgZ(6,"svg",6),e._UZ(7,"path",7)(8,"path",8)(9,"path",9)(10,"path",10),e.qZA(),e.kcU(),e.TgZ(11,"div",11),e._uU(12,"Welcome to VirtualTRUST"),e.TgZ(13,"sup"),e._uU(14,"TM"),e.qZA()()(),e.TgZ(15,"div",12)(16,"div",13),e.O4$(),e.TgZ(17,"svg",14),e._UZ(18,"path",15),e.qZA(),e._uU(19," Login "),e.qZA(),e.kcU(),e.TgZ(20,"div",16),e._uU(21,"Please login using your email address and password."),e.qZA(),e.TgZ(22,"form",17),e.NdJ("ngSubmit",function(){return n.logIn()}),e.TgZ(23,"div",18)(24,"div",19)(25,"div",20)(26,"div",21)(27,"label",22),e._uU(28,"Email Address*"),e.qZA()(),e.TgZ(29,"div",23),e._UZ(30,"input",24),e.qZA(),e.YNc(31,B,2,0,"div",25),e.qZA()()(),e.TgZ(32,"div",18)(33,"div",19)(34,"div",20)(35,"div",21)(36,"label",22),e._uU(37,"Password*"),e.qZA()(),e.TgZ(38,"div",23),e._UZ(39,"input",26),e.qZA(),e.YNc(40,V,2,0,"div",25),e.qZA()()(),e.TgZ(41,"div",27)(42,"div",28)(43,"div",29)(44,"label",30),e._uU(45,"Remember me "),e._UZ(46,"input",31)(47,"span",32),e.qZA()()(),e.TgZ(48,"div",33)(49,"div",34)(50,"a",35),e._uU(51,"Forgot Password?"),e.qZA()()()(),e.TgZ(52,"div",18)(53,"div",36)(54,"div",37),e.YNc(55,Q,2,0,"button",38),e.TgZ(56,"div",39),e.YNc(57,O,1,0,"mat-spinner",40),e.qZA()()()()(),e.TgZ(58,"div",41),e._uU(59,"New to our platform? "),e.TgZ(60,"a",35),e._uU(61,"Create an account"),e.qZA()()()()(),e.TgZ(62,"div",42)(63,"div",43)(64,"div",44)(65,"div",45),e._UZ(66,"img",46),e.qZA(),e.TgZ(67,"div",11),e._uU(68,"VirtualTRUST"),e.TgZ(69,"sup"),e._uU(70,"TM"),e.qZA()(),e.TgZ(71,"div",47),e._uU(72,"Login to get started with VirtualTRUST"),e.TgZ(73,"sup"),e._uU(74,"TM"),e.qZA()()()()()()()()),2&o&&(e.xp6(22),e.Q6J("formGroup",n.loginForm),e.xp6(9),e.Q6J("ngIf",n.loginForm.controls.username.hasError("required")&&(n.loginForm.controls.username.dirty||n.loginForm.controls.username.touched)),e.xp6(9),e.Q6J("ngIf",n.loginForm.controls.password.hasError("required")&&(n.loginForm.controls.password.dirty||n.loginForm.controls.password.touched)),e.xp6(15),e.Q6J("ngIf",!n.isLoading),e.xp6(2),e.Q6J("ngIf",n.isLoading))},dependencies:[m.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,p.Ou]}),s})(),canActivate:[P.i]},{path:"change-password",component:J,canActivate:[()=>{const s=(0,e.f3M)(u.F0),r=localStorage.getItem("vt-demo-isUserLoginFirstTime");return!(!r||"1"!==r)||s.parseUrl("/auth/login")}]}]}];let $=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[u.Bz.forChild(E),u.Bz]}),s})(),D=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,C.m,i.UX,p.Cq,$]}),s})()}}]);